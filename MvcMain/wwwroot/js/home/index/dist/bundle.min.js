(function e(n,t,i){function r(u,e){var s,h,o;if(!t[u]){if(!n[u]){if(s=typeof require=="function"&&require,!e&&s)return s(u,!0);if(f)return f(u,!0);h=new Error("Cannot find module '"+u+"'");throw h.code="MODULE_NOT_FOUND",h;}o=t[u]={exports:{}};n[u][0].call(o.exports,function(t){var i=n[u][1][t];return r(i?i:t)},o,o.exports,e,n,t,i)}return t[u].exports}for(var f=typeof require=="function"&&require,u=0;u<i.length;u++)r(i[u]);return r})({1:[function(n,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var r=n("../../../Events/EventDispatcher"),u=function(){function n(n,t){this._firstLevelTemplate="category1Template";this._firstLevelDiv="category1";this._firstLevelSelect="select1";this._secondLevelTemplate="category2Template";this._secondLevelDiv="category2";this._secondLevelSelect="select2";this._thirdLevelTemplate="category3Template";this._thirdLevelDiv="category3";this._thirdLevelSelect="select3";this._rootCategoryId=0;this.SelectedCategoryChangedEvent=new r.EventDispatcher;this._parentDivId=n;this._allCategories=t}return n.prototype.GetSelectedCategoryId=function(){return this._selectedCategoryIdLevelThree!==undefined&&this._selectedCategoryIdLevelThree!==this._rootCategoryId?this._selectedCategoryIdLevelThree:this._selectedCategoryIdLevelTwo!==undefined&&this._selectedCategoryIdLevelTwo!==this._rootCategoryId?this._selectedCategoryIdLevelTwo:this._selectedCategoryIdLevelOne},n.prototype.removeElement=function(n){$("#"+n).remove()},n.prototype.CreateFirstLevel=function(){var n=this,i;this.removeElement(this._firstLevelDiv);this._selectedCategoryIdLevelOne=this._rootCategoryId;this.removeElement(this._secondLevelDiv);this._selectedCategoryIdLevelTwo=this._rootCategoryId;this.removeElement(this._thirdLevelDiv);this._selectedCategoryIdLevelThree=this._rootCategoryId;var r=$("#"+this._firstLevelTemplate).html(),t=[],u={categories:t};this._selectedCategoryIdLevelOne=this._rootCategoryId;this._allCategories.forEach(function(i){i.parentCategoryId===n._rootCategoryId&&t.push(i)});i=Mustache.to_html(r,u);$("#"+this._parentDivId).append(i);$("#"+this._firstLevelSelect).change(function(t){var i=parseInt($(t.currentTarget).val().toString());n._selectedCategoryIdLevelOne=i;n.createSecondLevel(i);n.SelectedCategoryChangedEvent.dispatch(n,n.GetSelectedCategoryId())})},n.prototype.createSecondLevel=function(n){var t=this,r;if(this.removeElement(this._secondLevelDiv),this._selectedCategoryIdLevelTwo=this._rootCategoryId,this.removeElement(this._thirdLevelDiv),this._selectedCategoryIdLevelThree=this._rootCategoryId,n!==this._rootCategoryId){var u=$("#"+this._secondLevelTemplate).html(),i=[],f={categories:i};this._allCategories.forEach(function(t){t.parentCategoryId===n&&i.push(t)});r=Mustache.to_html(u,f);$("#"+this._parentDivId).append(r);$("#"+this._secondLevelSelect).change(function(n){var i=parseInt($(n.currentTarget).val().toString());t._selectedCategoryIdLevelTwo=i;t.createThirdLevel(i);t.SelectedCategoryChangedEvent.dispatch(t,t.GetSelectedCategoryId())})}},n.prototype.createThirdLevel=function(n){var t=this,r;if(this.removeElement(this._thirdLevelDiv),this._selectedCategoryIdLevelThree=this._rootCategoryId,n!==this._rootCategoryId){var u=$("#"+this._thirdLevelTemplate).html(),i=[],f={categories:i};(this._allCategories.forEach(function(t){t.parentCategoryId===n&&i.push(t)}),i.length!==0)&&(r=Mustache.to_html(u,f),$("#"+this._parentDivId).append(r),$("#"+this._thirdLevelSelect).change(function(n){t._selectedCategoryIdLevelThree=parseInt($(n.currentTarget).val().toString());t.SelectedCategoryChangedEvent.dispatch(t,t.GetSelectedCategoryId())}))}},n}();i.CategorySelection=u},{"../../../Events/EventDispatcher":2}],2:[function(n,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var r=function(){function n(){this._subscriptions=[]}return n.prototype.Subscribe=function(n){n&&this._subscriptions.push(n)},n.prototype.Unsubscribe=function(n){var t=this._subscriptions.indexOf(n);t>-1&&this._subscriptions.splice(t,1)},n.prototype.dispatch=function(n,t){for(var u,i=0,r=this._subscriptions;i<r.length;i++)u=r[i],u(n,t)},n}();i.EventDispatcher=r},{}],3:[function(n,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var r=function(){function n(){}return n}();i.CriteriaNumericDictionary=r},{}],4:[function(n,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var r=function(){function n(){this.ParametersDictionary={}}return n}();i.UserInput=r},{}],5:[function(n,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var r=n("./SearchCriteria/AdTransformationSearchCriteria"),u=n("./SearchCriteria/DefaultSearchCriteria"),f=n("../../../Helper/CriteriaNumericDictionary"),e=function(){function n(){this._searchCriteriaIocContainer=new f.CriteriaNumericDictionary;this.initSearchCriteriaIocContainer()}return n.prototype.initSearchCriteriaIocContainer=function(){this._searchCriteriaIocContainer[0]=new u.DefaultSearchCriteria;this._searchCriteriaIocContainer[100]=new r.AdTransformationSearchCriteria},n.prototype.FillCategorySpecificSearchCriteria=function(n,t){var i=this.polymorphicDispatchSearchCriteria(n);i.FillCriteria(t)},n.prototype.Bind=function(n,t){var i=this.polymorphicDispatchSearchCriteria(n);i.BindEvents(t)},n.prototype.UnBind=function(n){var t=this.polymorphicDispatchSearchCriteria(n);t.UnBindEvents()},n.prototype.polymorphicDispatchSearchCriteria=function(n){var t=this._searchCriteriaIocContainer[n];return(t===undefined||t===null)&&(t=this._searchCriteriaIocContainer[0]),t},n}();i.SearchCriteria=e},{"../../../Helper/CriteriaNumericDictionary":3,"./SearchCriteria/AdTransformationSearchCriteria":7,"./SearchCriteria/DefaultSearchCriteria":8}],6:[function(n,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var r=n("../../newAd/src/NewAdPartialViewLoader"),u=n("./SearchCriteria"),f=function(){function n(n,t){this._url="Home/GetSearchCriteriaView";this._previousCategoryId=0;this._currentCategoryId=0;this._searchCriteria=new u.SearchCriteria;this._parentDivId=n;this._searchCriteriaChange=t}return n.prototype.GetSearchCriteriaViewFromServer=function(n){var i=this,t;this._currentCategoryId=n;t=new r.PartialViewServerCallParameters;t.CategoryId=n;$.ajax({type:"GET",url:this._url,data:t,success:function(n,t,r){return i.onSuccessGetItemsFromServer(n,t,r)},error:function(n,t,r){return i.onErrorGetItemsFromServer(n,t,r)}})},n.prototype.onSuccessGetItemsFromServer=function(n){this._searchCriteria.UnBind(this._previousCategoryId);$("#"+this._parentDivId).children().remove();$("#"+this._parentDivId).html(n);this._searchCriteria.Bind(this._currentCategoryId,this._searchCriteriaChange);this._previousCategoryId=this._currentCategoryId},n.prototype.onErrorGetItemsFromServer=function(n,t,i){alert(i)},n}();i.SearchCriteriaViewLoader=f},{"../../newAd/src/NewAdPartialViewLoader":11,"./SearchCriteria":5}],7:[function(n,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var r=function(){function n(){this.CarBrandIdKey="BrandId";this.BrandSelectId="brand";this.CarModelTemplateId="modelTemplate";this.CarModelDivPlaceHolderId="modelPlaceHolder";this.CarModelIdKey="CarModelId";this.AllCarModelsInputId="allCarModels";this.ModelSelectId="model";this.MakeYearFromKey="MakeYearFrom";this.MakeYearFromInputId="fromYear";this.MakeYearToKey="MakeYearTo";this.MakeYearToInputId="toYear";this.FuelKey="Fuel";this.FuelSelectId="fuel";this.MileageFromKey="MileageFrom";this.MileageFromInputId="mileageFrom";this.MileageToKey="MileageTo";this.MileageToInputId="mileageTo";this.GearboxKey="Gearbox";this.GearboxTypeSelectId="gearboxType";this.BodyColorKey="BodyColor";this.BodyColorSelectId="bodyColor";this.InternalColorKey="InternalColor";this.InternalColorSelectId="internalColor";this.BodyStatusKey="BodyStatus";this.BodyStatusSelectId="bodyStatus";this.CarStatusKey="CarStatus";this.CarStatusSelectId="carStatus";this.PlateTypeKey="PlateType";this.PlateTypeSelectId="plateType"}return n.prototype.initView=function(){var n=$("#"+this.AllCarModelsInputId).val().toString();this._allCarModels=$.parseJSON(n);this.initCarModel()},n.prototype.initCarModel=function(){this.createCarModelElement([])},n.prototype.updateCarModelSelect=function(n){var t=[];this._allCarModels.forEach(function(i){i.brandId===n&&t.push(i)});this.createCarModelElement(t)},n.prototype.createCarModelElement=function(n){$("#"+this.CarModelDivPlaceHolderId).children().remove();var t=$("#"+this.CarModelTemplateId).html(),i={carModels:n},r=Mustache.to_html(t,i);$("#"+this.CarModelDivPlaceHolderId).append(r);this.bindCarModel()},n.prototype.FillCriteria=function(n){n.ParametersDictionary[this.CarBrandIdKey]=$("#"+this.BrandSelectId).find("option:selected").val();n.ParametersDictionary[this.CarModelIdKey]=$("#"+this.ModelSelectId).find("option:selected").val();n.ParametersDictionary[this.MakeYearFromKey]=$("#"+this.MakeYearFromInputId).val();n.ParametersDictionary[this.MakeYearToKey]=$("#"+this.MakeYearToInputId).val();n.ParametersDictionary[this.FuelKey]=$("#"+this.FuelSelectId).find("option:selected").val();n.ParametersDictionary[this.MileageFromKey]=$("#"+this.MileageFromInputId).val();n.ParametersDictionary[this.MileageToKey]=$("#"+this.MileageToInputId).val();n.ParametersDictionary[this.GearboxKey]=$("#"+this.GearboxTypeSelectId).find("option:selected").val();n.ParametersDictionary[this.BodyColorKey]=$("#"+this.BodyColorSelectId).find("option:selected").val();n.ParametersDictionary[this.InternalColorKey]=$("#"+this.InternalColorSelectId).find("option:selected").val();n.ParametersDictionary[this.BodyStatusKey]=$("#"+this.BodyStatusSelectId).find("option:selected").val();n.ParametersDictionary[this.CarStatusKey]=$("#"+this.CarStatusSelectId).find("option:selected").val();n.ParametersDictionary[this.PlateTypeKey]=$("#"+this.PlateTypeSelectId).find("option:selected").val()},n.prototype.BindEvents=function(n){var t=this;this._searchCriteriaChange=n;this.initView();$("#"+this.BrandSelectId).on("change",function(i){var r=parseInt($(i.currentTarget).find("option:selected").val().toString());t.updateCarModelSelect(r);n.CustomCriteriChanged()});this.bindCarModel()},n.prototype.bindCarModel=function(){var n=this;$("#"+this.ModelSelectId).on("change",function(){n._searchCriteriaChange.CustomCriteriChanged()})},n.prototype.UnBindEvents=function(){$("#"+this.BrandSelectId).off("change");this.unBindCarModel()},n.prototype.unBindCarModel=function(){$("#"+this.ModelSelectId).off("change")},n}();i.AdTransformationSearchCriteria=r},{}],8:[function(n,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var r=function(){function n(){}return n.prototype.FillCriteria=function(n){n.ParametersDictionary.defaultParameter=1234},n.prototype.BindEvents=function(){},n.prototype.UnBindEvents=function(){},n}();i.DefaultSearchCriteria=r},{}],9:[function(n,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var r=function(){function n(){this._initialStart=1;this._start=1;this._count=5;this._currentRequestIndex=0;this._initialRequestIndex=0;this._isServerCalled=!1;this._numberOfStartServerCallNotification=0;this._url="api/AdApi/GetAdvertisementCommon"}return n.prototype.GetAdItemsFromServer=function(n){var t=this;n.ParametersDictionary.StartIndex=this._start;n.ParametersDictionary.Count=this._count;this._currentRequestIndex++;n.ParametersDictionary.RequestIndex=this._currentRequestIndex;$.ajax({type:"POST",url:this._url,data:JSON.stringify(n.ParametersDictionary),contentType:"application/json",success:function(n,i,r){return t.onSuccessGetItemsFromServer(n,i,r)},error:function(n,i,r){return t.onErrorGetItemsFromServer(n,i,r)}});this._isServerCalled=!0;this.notifyUserAjaxCallStarted()},n.prototype.onSuccessGetItemsFromServer=function(n){var r,u,t,i,f;if(console.log("server response request index:"+n.customDictionary.RequestIndex+", client current request index:"+this._currentRequestIndex),this._isServerCalled&&n.customDictionary.RequestIndex==this._currentRequestIndex&&(this._isServerCalled=!1,this.notifyUserAjaxCallFinished(),n.success==!0))for(console.log("processing request index:"+this._currentRequestIndex),this._start+=parseInt(n.customDictionary.numberOfItems),r=$("#singleAdItem").html(),t=0;t<n.responseData.length;t++)i=null,n.responseData[t].advertisementImages[0]!=null&&(i="data:image/jpg;base64,"+n.responseData[t].advertisementImages[0]),u={AdvertisementId:n.responseData[t].advertisementId,AdvertisementCategoryId:n.responseData[t].advertisementCategoryId,AdvertisementCategory:n.responseData[t].advertisementCategory,adImage:i,adPrice:n.responseData[t].advertisementPrice.price,AdvertisementTitle:n.responseData[t].advertisementTitle,AdvertisementStatus:n.responseData[t].advertisementStatus},f=Mustache.to_html(r,u),$("#adPlaceHolder").append(f)},n.prototype.onErrorGetItemsFromServer=function(){this._isServerCalled=!1;this.notifyUserAjaxCallFinished()},n.prototype.ResetSearchParameters=function(){this._start=this._initialStart},n.prototype.notifyUserAjaxCallStarted=function(){console.log("Started Ajax Call");$("#serverCalledImage").show()},n.prototype.notifyUserAjaxCallFinished=function(){console.log("Finished Ajax Call");$("#serverCalledImage").hide()},n}();i.ServerCaller=r},{}],10:[function(n,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var u=n("../../../Components/Category/SearchAd/CategorySelection"),f=n("./ServerCaller"),e=n("./SearchCriteriaViewLoader"),o=n("./SearchCriteria"),s=n("../../../Helper/UserInput"),r=function(){function n(n,t,i){this._orderBySelectIdDiv="orderBy";this._minPriceInputId="minPrice";this._maxPriceInputId="maxPrice";this._serverCaller=new f.ServerCaller;this._searchCriteriaViewLoader=new e.SearchCriteriaViewLoader("categorySpecificSearchCriteria",this);this._searchCriteria=new o.SearchCriteria;this._categorySelectorParentDivId=n;this._allCategoriesId=t;this._getAdFromServerId=i;this.initPage();this.initEventHandlers()}return n.prototype.initPage=function(){this.initCategorySelectionControl();this.initGetAdFromServer();this.initSingleAdItemStyle()},n.prototype.initCategorySelectionControl=function(){var n=$("#"+this._allCategoriesId).val().toString(),t=$.parseJSON(n);this._categorySelection=new u.CategorySelection(this._categorySelectorParentDivId,t);this._categorySelection.CreateFirstLevel()},n.prototype.initEventHandlers=function(){var n=this;this._categorySelection.SelectedCategoryChangedEvent.Subscribe(function(t,i){n.searchCriteriaChanged();n._searchCriteriaViewLoader.GetSearchCriteriaViewFromServer(i)});$("#"+this._orderBySelectIdDiv).on("change",function(){n.searchCriteriaChanged()});$("#"+this._minPriceInputId).on("input",function(){n.searchCriteriaChanged()});$("#"+this._maxPriceInputId).on("change",function(){n.searchCriteriaChanged()})},n.prototype.CustomCriteriChanged=function(){this.searchCriteriaChanged()},n.prototype.searchCriteriaChanged=function(){$("#adPlaceHolder").children().remove();this._serverCaller.ResetSearchParameters();$("#"+this._getAdFromServerId).trigger("click")},n.prototype.initGetAdFromServer=function(){var n=this;$("#"+this._getAdFromServerId).on("click",function(t){var i,r,u,f,e;t.preventDefault();i=new s.UserInput;r=n._categorySelection.GetSelectedCategoryId();i.ParametersDictionary.CategoryId=r;u=parseInt($("#minPrice").val().toString());i.ParametersDictionary.MinimumPrice=u;f=parseInt($("#maxPrice").val().toString());i.ParametersDictionary.MaximumPrice=f;e=$("#orderBy").val().toString();i.ParametersDictionary.OrderBy=e;n._searchCriteria.FillCategorySpecificSearchCriteria(r,i);n._serverCaller.GetAdItemsFromServer(i)})},n.prototype.initSingleAdItemStyle=function(){$(document).on("mouseenter mouseleave",".blockDisplay",function(n){$(n.currentTarget).find(".moreInfo").fadeToggle(250)})},n}();i.Index=r;var h="categorySelector",c="getAdFromServer",l="allCategories";$(document).ready(function(){var n=new r(h,l,c);n.CustomCriteriChanged()})},{"../../../Components/Category/SearchAd/CategorySelection":1,"../../../Helper/UserInput":4,"./SearchCriteria":5,"./SearchCriteriaViewLoader":6,"./ServerCaller":9}],11:[function(n,t,i){"use strict";var u,r;Object.defineProperty(i,"__esModule",{value:!0});u=function(){function n(n){this._url="/Home/GetNewAdPartialView";this._partialViewDivId=n}return n.prototype.GetPartialViewFromServer=function(n){var t=this,i=new r;i.CategoryId=n;$.ajax({type:"GET",url:this._url,data:i,success:function(n,i,r){return t.onSuccessGetItemsFromServer(n,i,r)},error:function(n,i,r){return t.onErrorGetItemsFromServer(n,i,r)}})},n.prototype.onSuccessGetItemsFromServer=function(n){$("#"+this._partialViewDivId).children().remove();$("#"+this._partialViewDivId).html(n)},n.prototype.onErrorGetItemsFromServer=function(n,t,i){alert(i)},n}();i.NewAdPartialViewLoader=u;r=function(){function n(){}return n}();i.PartialViewServerCallParameters=r},{}]},{},[10]);