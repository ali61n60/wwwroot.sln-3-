define(["require","exports","../Components/CategorySelection"],function(n,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i.CategorySelection;$(document).ready(function(){var n=new ServerCaller;$("#getAdFromServer").on("click",function(t){t.preventDefault();var i=new r("#categorySelector",null).GetSelectedCategoryId(),u=parseInt($("#minPrice").val().toString()),f=parseInt($("#maxPrice").val().toString()),e=$("#orderBy").val().toString();n.GetAdItemsFromServer(i,u,f,e)})});$(document).ready(function(){$(document).on("mouseenter mouseleave",".blockDisplay",function(){$(this).find(".moreInfo").fadeToggle(250)})})});var SearchAdUserInput=function(){function n(){}return n}(),ServerCaller=function(){function n(){this._initialStart=1;this._start=1;this._count=5;this._requestIndex=0;this._previousRequestIndex=-1;this._isServerCalled=!1;this._numberOfStartServerCallNotification=0}return n.prototype.GetAdItemsFromServer=function(n,t,i,r){var u=new SearchAdUserInput,f;this._isServerCalled&&this._previousRequestIndex===this._requestIndex||(this._previousRequestIndex=this._requestIndex,this._isServerCalled=!0,u.StartIndex=this._start,u.Count=this._count,u.CategoryId=n,u.MinimumPrice=t,u.MaximumPrice=i,u.OrderBy=r,u.RequestIndex=this._requestIndex,f=this,$.ajax({type:"POST",url:"api/AdApi/GetAdvertisementCommon",data:JSON.stringify(u),contentType:"application/json",success:function(n){f.onSuccessGetItemsFromServer(n)},error:f.onErrorGetItemsFromServer}))},n.prototype.onSuccessGetItemsFromServer=function(n){var r,u,t,i,f;if(n.success==!0&&n.customDictionary.RequestIndex==this._requestIndex)for(this._start+=parseInt(n.customDictionary.numberOfItems),r=$("#singleAdItem").html(),t=0;t<n.responseData.length;t++)i=null,n.responseData[t].advertisementImages[0]!=null&&(i="data:image/jpg;base64,"+n.responseData[t].advertisementImages[0]),u={AdvertisementId:n.responseData[t].advertisementId,AdvertisementCategoryId:n.responseData[t].advertisementCategoryId,AdvertisementCategory:n.responseData[t].advertisementCategory,adImage:i,adPrice:n.responseData[t].advertisementPrice.price,AdvertisementTitle:n.responseData[t].advertisementTitle,AdvertisementStatus:n.responseData[t].advertisementStatus},f=Mustache.to_html(r,u),$("#adPlaceHolder").append(f);this._isServerCalled=!1;this._requestIndex++},n.prototype.onErrorGetItemsFromServer=function(){this._isServerCalled=!1;this._requestIndex++},n}();define(["require","exports"],function(n,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function n(){}return n}(),i=function(){function n(n,t){this._firstLevelSelectId="category1";this._secondLevelSelectId="category2";this._thirdLevelSelectId="category3";this._rootCategoryId=0;this._parentDivId=n;this._allCategories=t}return n.prototype.GetSelectedCategoryId=function(){return n._selectedCategoryIdLevelThree!==this._rootCategoryId?n._selectedCategoryIdLevelThree:n._selectedCategoryIdLevelTwo!==this._rootCategoryId?n._selectedCategoryIdLevelTwo:n._selectedCategoryIdLevelOne},n.prototype.CreateFirstLevel=function(){var t=this;n._selectedCategoryIdLevelOne=this._rootCategoryId;this._allCategories.forEach(function(n){n.parentCategoryId===t._rootCategoryId&&$("#"+t._firstLevelSelectId).append($("<option>",{value:n.categoryId,text:n.categoryName}))});$("#"+this._firstLevelSelectId).change(function(){var i=parseInt($(this).val().toString());n._selectedCategoryIdLevelOne=i;t.CreateSecondLevel(i)})},n.prototype.CreateSecondLevel=function(t){var r=this,i;(n._selectedCategoryIdLevelTwo=this._rootCategoryId,$("#"+this._secondLevelSelectId).remove(),$("#"+this._thirdLevelSelectId).remove(),t!==this._rootCategoryId)&&(i=$('<select id="'+this._secondLevelSelectId+'" class="form-control"><\/select>').append('<option value="'+this._rootCategoryId+'">تمام آگهی ها<\/option>'),this._allCategories.forEach(function(n){n.parentCategoryId===t&&i.append($("<option>",{value:n.categoryId,text:n.categoryName}))}),$("#"+this._parentDivId).append(i),$("#"+this._secondLevelSelectId).change(function(){var t=parseInt($(this).val().toString());n._selectedCategoryIdLevelTwo=t;r.CreateThirdLevel(t)}))},n.prototype.CreateThirdLevel=function(t){var r=this,i;(n._selectedCategoryIdLevelThree=this._rootCategoryId,$("#"+this._thirdLevelSelectId).remove(),t!==this._rootCategoryId)&&(i=$('<select id="'+this._thirdLevelSelectId+'" class="form-control"><\/select>').append('<option value="'+this._rootCategoryId+'">تمام آگهی ها<\/option>'),this._allCategories.forEach(function(n){n.parentCategoryId===t&&i.append($("<option>",{value:n.categoryId,text:n.categoryName}))}),$("#"+this._parentDivId).append(i),$("#"+this._thirdLevelSelectId).change(function(){var t=parseInt($(this).val().toString());n._selectedCategoryIdLevelThree=t}))},n}();t.CategorySelection=i;$(document).ready(function(){var n=$("#allCategories").val().toString(),t=$.parseJSON(n),r=new i("categorySelector",t);r.CreateFirstLevel()})});