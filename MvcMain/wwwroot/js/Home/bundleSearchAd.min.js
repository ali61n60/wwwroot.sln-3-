var CategorySelection,SearchAdUserInput,ServerCaller;$(document).ready(function(){var n=new ServerCaller;$("#getAdFromServer").on("click",function(t){t.preventDefault();var i=new CategorySelection("#categorySelector").GetSelectedCategoryId(),r=parseInt($("#minPrice").val().toString()),u=parseInt($("#maxPrice").val().toString()),f=$("#orderBy").val().toString();n.GetAdItemsFromServer(i,r,u,f)})});$(document).ready(function(){$(document).on("mouseenter mouseleave",".blockDisplay",function(){$(this).find(".moreInfo").fadeToggle(250)})});CategorySelection=function(){function n(n){this._parentDivId=n}return n.prototype.GetSelectedCategoryId=function(){var t=$(this._parentDivId+" #category0"),n=parseInt(t.val().toString());return n===NaN&&(n=0),n},n}();$(document).ready(function(){var t=$("#allCategories").val().toString(),n=$.parseJSON(t);n.forEach(function(n){n.parentCategoryId===0&&$("#category0").append($("<option>",{value:n.categoryId,text:n.categoryName}))});$("#category0").change(function(){$("#category1").remove();var i=$(this).val(),t=$("<br/> <select id='category1' class='form-control'><\/select>").append("<option value='0'>تمام آگهی ها<\/option>");n.forEach(function(n){n.parentCategoryId==i&&t.append($("<option>",{value:n.categoryId,text:n.categoryName}))});$("#categorySelector").append(t)})});SearchAdUserInput=function(){function n(){}return n}();ServerCaller=function(){function n(){this._initialStart=1;this._start=1;this._count=5;this._requestIndex=0;this._previousRequestIndex=-1;this._isServerCalled=!1;this._numberOfStartServerCallNotification=0}return n.prototype.GetAdItemsFromServer=function(n,t,i,r){var u=new SearchAdUserInput,f;this._isServerCalled&&this._previousRequestIndex===this._requestIndex||(this._previousRequestIndex=this._requestIndex,this._isServerCalled=!0,u.StartIndex=this._start,u.Count=this._count,u.CategoryId=n,u.MinimumPrice=t,u.MaximumPrice=i,u.OrderBy=r,u.RequestIndex=this._requestIndex,f=this,$.ajax({type:"POST",url:"api/AdApi/GetAdvertisementCommon",data:JSON.stringify(u),contentType:"application/json",success:function(n){f.onSuccessGetItemsFromServer(n)},error:f.onErrorGetItemsFromServer}))},n.prototype.onSuccessGetItemsFromServer=function(n){var r,u,t,i,f;if(n.success==!0&&n.customDictionary.RequestIndex==this._requestIndex)for(this._start+=parseInt(n.customDictionary.numberOfItems),r=$("#singleAdItem").html(),t=0;t<n.responseData.length;t++)i=null,n.responseData[t].advertisementImages[0]!=null&&(i="data:image/jpg;base64,"+n.responseData[t].advertisementImages[0]),u={AdvertisementId:n.responseData[t].advertisementId,AdvertisementCategoryId:n.responseData[t].advertisementCategoryId,AdvertisementCategory:n.responseData[t].advertisementCategory,adImage:i,adPrice:n.responseData[t].advertisementPrice.price,AdvertisementTitle:n.responseData[t].advertisementTitle,AdvertisementStatus:n.responseData[t].advertisementStatus},f=Mustache.to_html(r,u),$("#adPlaceHolder").append(f);this._isServerCalled=!1;this._requestIndex++},n.prototype.onErrorGetItemsFromServer=function(){this._isServerCalled=!1;this._requestIndex++},n}();