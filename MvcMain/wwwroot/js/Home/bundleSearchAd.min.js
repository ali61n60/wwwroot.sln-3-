$(document).ready(function(){var n=new ServerCaller;$("#getAdFromServer").on("click",function(t){t.preventDefault();var i=new CategorySelection("#categorySelector",null).GetSelectedCategoryId(),r=parseInt($("#minPrice").val().toString()),u=parseInt($("#maxPrice").val().toString()),f=$("#orderBy").val().toString();n.GetAdItemsFromServer(i,r,u,f)})});$(document).ready(function(){$(document).on("mouseenter mouseleave",".blockDisplay",function(){$(this).find(".moreInfo").fadeToggle(250)})});var SearchAdUserInput=function(){function n(){}return n}(),ServerCaller=function(){function n(){this._initialStart=1;this._start=1;this._count=5;this._requestIndex=0;this._previousRequestIndex=-1;this._isServerCalled=!1;this._numberOfStartServerCallNotification=0}return n.prototype.GetAdItemsFromServer=function(n,t,i,r){var u=new SearchAdUserInput,f;this._isServerCalled&&this._previousRequestIndex===this._requestIndex||(this._previousRequestIndex=this._requestIndex,this._isServerCalled=!0,u.StartIndex=this._start,u.Count=this._count,u.CategoryId=n,u.MinimumPrice=t,u.MaximumPrice=i,u.OrderBy=r,u.RequestIndex=this._requestIndex,f=this,$.ajax({type:"POST",url:"api/AdApi/GetAdvertisementCommon",data:JSON.stringify(u),contentType:"application/json",success:function(n){f.onSuccessGetItemsFromServer(n)},error:f.onErrorGetItemsFromServer}))},n.prototype.onSuccessGetItemsFromServer=function(n){var r,u,t,i,f;if(n.success==!0&&n.customDictionary.RequestIndex==this._requestIndex)for(this._start+=parseInt(n.customDictionary.numberOfItems),r=$("#singleAdItem").html(),t=0;t<n.responseData.length;t++)i=null,n.responseData[t].advertisementImages[0]!=null&&(i="data:image/jpg;base64,"+n.responseData[t].advertisementImages[0]),u={AdvertisementId:n.responseData[t].advertisementId,AdvertisementCategoryId:n.responseData[t].advertisementCategoryId,AdvertisementCategory:n.responseData[t].advertisementCategory,adImage:i,adPrice:n.responseData[t].advertisementPrice.price,AdvertisementTitle:n.responseData[t].advertisementTitle,AdvertisementStatus:n.responseData[t].advertisementStatus},f=Mustache.to_html(r,u),$("#adPlaceHolder").append(f);this._isServerCalled=!1;this._requestIndex++},n.prototype.onErrorGetItemsFromServer=function(){this._isServerCalled=!1;this._requestIndex++},n}(),Category=function(){function n(){}return n}(),CategorySelection=function(){function n(n,t){this._firstLevelSelectId="category1";this._secondLevelSelectId="category2";this._thirdLevelSelectId="category3";this._rootCategoryId=0;this._parentDivId=n;this._allCategories=t;console.log(this._allCategories)}return n.prototype.GetSelectedCategoryId=function(){var t=$(this._parentDivId+" #"+this._firstLevelSelectId),n=parseInt(t.val().toString());return n===NaN&&(n=this._rootCategoryId),n},n.prototype.CreateFirstLevel=function(){var n=this;this._allCategories.forEach(function(t){t.parentCategoryId===n._rootCategoryId&&$("#"+n._firstLevelSelectId).append($("<option>",{value:t.categoryId,text:t.categoryName}))});$("#"+this._firstLevelSelectId).change(function(){$("#"+n._secondLevelSelectId).remove();var i=parseInt($(this).val().toString()),t=$('<br/> <select id="'+n._secondLevelSelectId+'" class="form-control"><\/select>').append("<option value='0'>تمام آگهی ها<\/option>");n._allCategories.forEach(function(n){n.parentCategoryId===i&&t.append($("<option>",{value:n.categoryId,text:n.categoryName}))});$("#categorySelector").append(t)})},n.prototype.CreateSecondLevel=function(){},n}();$(document).ready(function(){var n=$("#allCategories").val().toString(),t=$.parseJSON(n),i=new CategorySelection("",t);i.CreateFirstLevel()});